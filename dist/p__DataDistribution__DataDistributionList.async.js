(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[12],{Dhqc:function(t,e,a){t.exports={distributeTitle:"antd-pro-pages-data-distribution-data-distribution-list-distributeTitle",distributeInput:"antd-pro-pages-data-distribution-data-distribution-list-distributeInput",distributeBtns:"antd-pro-pages-data-distribution-data-distribution-list-distributeBtns",cardPlatform:"antd-pro-pages-data-distribution-data-distribution-list-cardPlatform",card:"antd-pro-pages-data-distribution-data-distribution-list-card",platformContent:"antd-pro-pages-data-distribution-data-distribution-list-platformContent",platformLeft:"antd-pro-pages-data-distribution-data-distribution-list-platformLeft",platformRight:"antd-pro-pages-data-distribution-data-distribution-list-platformRight",platformRightText:"antd-pro-pages-data-distribution-data-distribution-list-platformRightText",upOrDown:"antd-pro-pages-data-distribution-data-distribution-list-upOrDown",trigger:"antd-pro-pages-data-distribution-data-distribution-list-trigger",activeColor:"antd-pro-pages-data-distribution-data-distribution-list-activeColor",distributeTable:"antd-pro-pages-data-distribution-data-distribution-list-distributeTable",syncTitleName:"antd-pro-pages-data-distribution-data-distribution-list-syncTitleName",contentLink:"antd-pro-pages-data-distribution-data-distribution-list-contentLink",extraImg:"antd-pro-pages-data-distribution-data-distribution-list-extraImg",pageHeaderContent:"antd-pro-pages-data-distribution-data-distribution-list-pageHeaderContent"}},r1zv:function(t,e,a){"use strict";a.r(e);a("1hTB");var i,r,n,s=a("KFXw"),o=(a("5hX3"),a("wjJH")),c=(a("QKdE"),a("2Vcd")),l=(a("jDyY"),a("q6Oz")),u=(a("B40R"),a("43HQ")),d=(a("Q1Fi"),a("7NCv")),p=(a("VIk5"),a("X+Ft")),m=(a("Hq/V"),a("fAnr")),f=(a("enMo"),a("1HgO")),h=(a("mqVB"),a("J2No")),g=a("mK77"),b=a.n(g),E=a("43Yg"),D=a.n(E),y=a("/tCh"),v=a.n(y),S=a("scpF"),w=a.n(S),C=a("O/V9"),N=a.n(C),P=a("Tfcp"),T=a.n(P),L=a("8aBX"),R=a.n(L),x=a("i9FB"),A=a.n(x),k=a("LneV"),I=a("Dhqc"),M=a.n(I),H=a("qj9E"),z=a("16fl"),O=a.n(z),V=a("1Haz"),B=a("lNND"),j=a("zHco"),F=(i=Object(k["connect"])(function(t){var e=t.dataDistribution,a=t.dataSyncNewMission,i=t.loading;return{dataDistribution:e,dataSyncNewMission:a,fetchLocalListStatus:i.effects["dataDistribution/fetchSourceListAction"],fetchRemoteListStatus:i.effects["dataDistribution/fetchRemoteClusterListAction"]}}),i((n=function(t){function e(){var t;return D()(this,e),t=w()(this,N()(e).call(this)),t.fetchDataList=function(){var e=t.props,a=e.dispatch,i=e.dataDistribution,r=i.platformType,n=t.state,s=n.currentPage,o=n.inputValue,c=n.clusterActiveColor,l=T()(t),u={};"cluster"===r&&(u={clusterId:c}),new Promise(function(t,e){a({type:"local"===r?"dataDistribution/fetchSourceListAction":"dataDistribution/fetchRemoteClusterListAction",params:b()({},u,{page:s,pageSize:B["c"].defaultPageSize,taskName:o}),resolve:t,reject:e})}).then(function(t){"true"===t.result?"local"===r&&l.setState({localResourcesAccessed:t.data.total}):H["a"].prompt.error(t.message)})},t.searchDataSource=function(){t.fetchDataList()},t.resetDataSource=function(){var e=T()(t);t.setState({inputValue:"",currentPage:B["c"].defaultPage},function(){e.fetchDataList()})},t.showDetailModal=function(e){var a=t.props,i=a.dispatch,r=a.dataDistribution,n=r.platformType;H["a"].storage.setStorage("processorId","local"===n?e.uuid:e.id),i({type:"dataSyncNewMission/changeDataSourceType",checkType:n}),O.a.push({pathname:"/dataDistribution/accessDetail",params:{isRouterPush:!0}})},t.showSingleDistributionModal=function(e){var a=t.props,i=(a.dispatch,a.dataDistribution),r=i.platformType;H["a"].storage.setStorage("processorId","local"===r?e.uuid:e.id),O.a.push({pathname:"/dataDistribution/distributeConfig",params:{data:e,isRouterPush:!0}})},t.pageChange=function(e){t.setState({currentPage:e.current},function(){t.fetchDataList()})},t.onInputChange=function(e){t.setState({inputValue:e.target.value})},t.unshiftArr=function(e){var a=t.state,i=a.platformExpand,r=a.localResourcesAccessed;return 0===e.length?e.unshift({isNew:!0,name:"\u672c\u5730\u5e73\u53f0",numberResourcesAccessed:r,remarks:"\u672c\u5730\u5e73\u53f0",id:"000"}):!e[0].hasOwnProperty("isNew")&&e.unshift({isNew:!0,name:"\u672c\u5730\u5e73\u53f0",numberResourcesAccessed:r,remarks:"\u672c\u5730\u5e73\u53f0",id:"000"}),t.changeList(e,i)},t.handleExpand=function(){var e=t.state.platformExpand;t.setState({platformExpand:!e})},t.changeList=function(t,e){return t.length>4&&!e?t.slice(0,4):t},t.onSelectPlatform=function(e){var a=t.props.dispatch;a({type:"dataDistribution/setPlatformTypeAction",platformType:"000"===e.id?"local":"cluster"}),t.setState({clusterActiveColor:e.id,currentPage:B["b"].defaultPage},function(){t.fetchDataList()})},t.state={currentPage:B["c"].defaultPage,pageSize:B["c"].defaultPageSize,inputValue:"",platformExpand:!1,localResourcesAccessed:0,clusterActiveColor:"000"},t}return R()(e,t),v()(e,[{key:"componentDidMount",value:function(){var t=this;H["a"].storage.setStorage("HtmlType",{modalType:"dataDestination",isProcessorEdit:!1});var e=this.props.dispatch,a=this.state.clusterActiveColor;new Promise(function(t,a){e({type:"dataSyncNewMission/fetchClusterManageListServicesAction",params:{},resolve:t,reject:a})}).then(function(e){"true"===e.result?t.fetchDataList():H["a"].prompt.error(e.message)}),"000"===a&&e({type:"dataDistribution/setPlatformTypeAction",platformType:"local"})}},{key:"componentWillUnmount",value:function(){this.props.dispatch}},{key:"render",value:function(){var t=this,e=this.props,a=e.fetchLocalListStatus,i=e.fetchRemoteListStatus,r=e.dataSyncNewMission,n=e.dataDistribution,g=n.sourceData,b=n.platformType,E=r.clusterPlatformList,D=this.state,y=D.currentPage,v=D.pageSize,S=D.inputValue,w=D.clusterActiveColor,C=D.platformExpand,N=[{title:"\u5e8f\u53f7",dataIndex:"key"},{title:"\u6570\u636e\u6e90\u540d\u79f0",dataIndex:"name"},{title:"\u63cf\u8ff0",dataIndex:"des"},{title:"\u63a5\u5165\u65f6\u95f4",dataIndex:"create_date",render:function(t){return A.a.createElement("span",null,H["a"].helper.dateFormat(t,"YYYY-MM-DD HH:mm:ss"))}},{title:"\u64cd\u4f5c",render:function(e,a){return A.a.createElement(x["Fragment"],null,A.a.createElement("a",{onClick:function(){return t.showDetailModal(a)}},"\u8be6\u60c5"),A.a.createElement(h["a"],{type:"vertical"}),A.a.createElement("a",{onClick:function(){return t.showSingleDistributionModal(a)}},"\u5206\u53d1\u914d\u7f6e"))}}];return A.a.createElement(j["a"],{title:"\u6570\u636e\u5206\u53d1"},A.a.createElement(d["a"],{className:M.a.distributeTitle},A.a.createElement(m["a"],{span:8},A.a.createElement("span",null,"\u6570\u636e\u6e90\u540d\u79f0"),A.a.createElement(f["a"],{className:M.a.distributeInput,value:S,placeholder:Object(V["formatMessage"])({id:"dataDistribution.index.PlaceHolder"}),onChange:this.onInputChange})),A.a.createElement(m["a"],{span:8,className:M.a.distributeBtns},A.a.createElement(p["a"],{onClick:this.searchDataSource},"\u67e5\u8be2"),A.a.createElement(p["a"],{onClick:this.resetDataSource,type:"primary"},"\u91cd\u7f6e"))),A.a.createElement("div",{className:M.a.cardPlatform},A.a.createElement(l["a"],null,A.a.createElement(c["a"],{rowKey:"id",grid:{gutter:24,lg:4,md:4,sm:4,xs:4},dataSource:this.unshiftArr(H["a"].lodash.orderBy(E,"create_date","desc")),renderItem:function(e){return A.a.createElement(c["a"].Item,{key:e.uuid,onClick:t.onSelectPlatform.bind(t,e),className:M.a.card},A.a.createElement(l["a"],{hoverable:!0,size:"default",id:e.hasOwnProperty("id")?e.id:"",style:{height:"82px"},className:w===e.id?M.a.activeColor:null},A.a.createElement("div",{className:M.a.platformContent},A.a.createElement("div",{className:M.a.platformLeft},e.name),e.hasOwnProperty("isNew")?A.a.createElement("div",{className:M.a.platformRight,style:{lineHeight:"40px"}},A.a.createElement("p",null,A.a.createElement(u["a"],{color:"#4ecb73"}),"\u5df2\u63a5\u5165\u8d44\u6e90\u6570\uff1a",A.a.createElement("span",{className:M.a.platformRightText},e.numberResourcesAccessed),"\u4e2a")):A.a.createElement("div",{className:M.a.platformRight},A.a.createElement("p",null,A.a.createElement(u["a"],{color:"#4ecb73"}),"\u5df2\u63a5\u5165\u8d44\u6e90\u6570\uff1a",A.a.createElement("span",{className:M.a.platformRightText},e.numberResourcesAccessed),"\u4e2a"),A.a.createElement("p",null,A.a.createElement(u["a"],{color:"#36cbcb"}),"\u53ef\u63a5\u5165\u8d44\u6e90\u6570\uff1a",A.a.createElement("span",{className:M.a.platformRightText},e.numberResourcesAccessible),"\u4e2a")))))}}),A.a.createElement("div",{className:M.a.upOrDown},A.a.createElement("a",{className:M.a.trigger,onClick:this.handleExpand.bind(this)},A.a.createElement(o["a"],{type:C?"up":"down"}))))),A.a.createElement(s["a"],{className:M.a.distributeTable,loading:"local"===b?a:i,dataSource:g.sourceList,pagination:{current:y,pageSize:v,total:g.hasOwnProperty("count")?g.count:0,showTotal:function(t){return"\u5171".concat(t,"\u6761")},showSizeChanger:!1,showQuickJumper:!1},columns:N,onChange:this.pageChange}))}}]),e}(x["PureComponent"]),r=n))||r);e["default"]=F}}]);