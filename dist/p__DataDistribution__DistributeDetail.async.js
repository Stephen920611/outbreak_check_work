(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[14],{iDoX:function(e,t,a){e.exports={missionDetailWrapper:"antd-pro-pages-data-distribution-distribute-detail-missionDetailWrapper",loading:"antd-pro-pages-data-distribution-distribute-detail-loading",missionStep:"antd-pro-pages-data-distribution-distribute-detail-missionStep",detailTitle:"antd-pro-pages-data-distribution-distribute-detail-detailTitle",detailSourceName:"antd-pro-pages-data-distribution-distribute-detail-detailSourceName",detailSourceBtns:"antd-pro-pages-data-distribution-distribute-detail-detailSourceBtns",detailBtns:"antd-pro-pages-data-distribution-distribute-detail-detailBtns",salesExtra:"antd-pro-pages-data-distribution-distribute-detail-salesExtra",currentDate:"antd-pro-pages-data-distribution-distribute-detail-currentDate",destinationName:"antd-pro-pages-data-distribution-distribute-detail-destinationName",detailItem:"antd-pro-pages-data-distribution-distribute-detail-detailItem",tableContainer:"antd-pro-pages-data-distribution-distribute-detail-tableContainer",detailLine:"antd-pro-pages-data-distribution-distribute-detail-detailLine",detailTable:"antd-pro-pages-data-distribution-distribute-detail-detailTable",detailTitleName:"antd-pro-pages-data-distribution-distribute-detail-detailTitleName",contentLink:"antd-pro-pages-data-distribution-distribute-detail-contentLink",extraImg:"antd-pro-pages-data-distribution-distribute-detail-extraImg",pageHeaderContent:"antd-pro-pages-data-distribution-distribute-detail-pageHeaderContent"}},is7U:function(e,t,a){"use strict";a.r(t);a("QKdE");var n,i,s,r=a("2Vcd"),l=(a("1hTB"),a("KFXw")),d=(a("jDyY"),a("q6Oz")),o=(a("avCb"),a("dbpm")),c=(a("Q1Fi"),a("7NCv")),u=(a("Hq/V"),a("fAnr")),m=(a("VIk5"),a("X+Ft")),p=(a("5hX3"),a("wjJH")),D=a("43Yg"),h=a.n(D),g=a("/tCh"),E=a.n(g),b=a("scpF"),f=a.n(b),N=a("O/V9"),y=a.n(N),v=a("Tfcp"),k=a.n(v),C=a("8aBX"),w=a.n(C),I=(a("I4dy"),a("+qVy")),S=a("i9FB"),P=a.n(S),T=a("LneV"),L=a("iDoX"),O=a.n(L),A=a("qj9E"),x=a("+n12"),B=a("rC0w"),M=a("1Haz"),U=a("zHco"),H=a("2kcH"),V=I["a"].RangePicker,F=(n=Object(T["connect"])(function(e){var t=e.dataDistribution,a=e.dataSyncNewMission,n=e.loading;return{dataDistribution:t,dataSyncNewMission:a,fetchDestinationDetailStatus:n.effects["dataDistribution/getDestinationDetailAction"],fetchSinkDetailLineDataStatus:n.effects["dataDistribution/getDetailLineDataBySinkIdAction"]}}),n((s=function(e){function t(){var e;return h()(this,t),e=f()(this,y()(t).call(this)),e.fetchDataList=function(){var t=e.props.dispatch,a=A["a"].storage.getStorage("processorId");t({type:"dataDistribution/getDestinationDetailAction",uuid:a})},e.fetchLineData=function(){var t=k()(e),a=e.props.dispatch,n=e.state.rangePickerValue,i=A["a"].storage.getStorage("processorId"),s=A["a"].moment(n[0]).format("YYYY-MM-DD HH:mm:ss"),r=A["a"].moment(n[1]).format("YYYY-MM-DD HH:mm:ss"),l=(new Date).getTime(),d=A["a"].helper.dateFormat(l);e.setState({updateTime:d}),new Promise(function(e,t){a({type:"dataDistribution/getDetailLineDataBySinkIdAction",id:i,params:{startTime:s,endTime:r},resolve:e,reject:t})}).then(function(e){"true"===e.result?t.setState({rateLineData:JSON.parse(e.data)}):A["a"].prompt.error(e.message)})},e.updateDistributeDetailInfo=function(){e.fetchDataList()},e.resetNode=function(t){var a=k()(e),n=e.props.dispatch,i=A["a"].storage.getStorage("processorId");new Promise(function(e,a){n({type:"dataDistribution/restartDestinationChildAction",id:i,taskId:t.worker_id,resolve:e,reject:a})}).then(function(e){"true"===e.result?(A["a"].prompt.success(e.data),a.fetchDataList()):A["a"].prompt.error(e.message)})},e.pageChange=function(t){e.setState({currentPage:t.current},function(){e.fetchDataList()})},e.handleDestination=function(t,a){var n=k()(e),i=e.props,s=i.dispatch,r=i.dataDistribution;r.sourceInfo;new Promise(function(e,n){s({type:"dataDistribution/"+("activate"===a?"runningDestinationAction":"pause"===a?"pauseDestinationAction":"restart"===a?"restartDestinationAction":"resume"===a?"resumeDestinationAction":"delete"===a?"deleteDestinationAction":""),uuid:t.id,resolve:e,reject:n})}).then(function(e){"true"===e.result?(A["a"].prompt.success(e.data),n.fetchDataList()):A["a"].prompt.error(e.message)})},e.selectDate=function(t){e.setState({rangePickerValue:Object(x["d"])(t)},function(){e.fetchLineData()})},e.handleRangePickerChange=function(t){e.setState({rangePickerValue:t},function(){e.fetchLineData()})},e.isActive=function(t){var a=e.state,n=a.rangePickerValue,i=(a.rangePickerType,Object(x["d"])(t));return n[0]&&n[1]&&n[0].isSame(i[0],"day")&&n[1].isSame(i[1],"day")?O.a.currentDate:""},e.lineTimer=null,e.state={rangePickerValue:Object(x["d"])("30min"),rangePickerType:"30min",updateTime:"---",rateLineData:[],infoData:{},stateAndRateData:{state:"UNSIGNED",rate:"--"},stateAndDetail:{state:[{state:"RUNNING",worker_id:"192.168.10.122:8083"},{id:0,state:"RUNNING",worker_id:"192.168.10.122:8083"}],allDetailData:[],detailTableData:[],logData:[]}},e}return w()(t,e),E()(t,[{key:"componentDidMount",value:function(){this.props.location;this.fetchDataList(),this.fetchLineData()}},{key:"componentWillUnmount",value:function(){clearInterval(this.lineTimer)}},{key:"render",value:function(){var e=this,t=this.props,a=t.fetchDestinationDetailStatus,n=t.dataDistribution,i=t.fetchSinkDetailLineDataStatus,s=this.state,D=s.rateLineData,h=s.rangePickerValue,g=(s.updateTime,n.sourceList,n.destinationDetail),E=(g.destination,g.status),b=g.statistics,f=g.logs,N=g.processor,y=[{title:"ID",dataIndex:"id"},{title:"\u72b6\u6001",dataIndex:"state"},{title:"\u8fd0\u884c\u8282\u70b9",dataIndex:"worker_id"},{title:"\u64cd\u4f5c",render:function(t,a){return P.a.createElement(S["Fragment"],null,P.a.createElement(p["a"],{type:"redo",title:"\u91cd\u542f",onClick:function(){return e.resetNode(a)}}))}}],v=[{title:"\u5e8f\u53f7",dataIndex:"key"},{title:"\u6570\u636e\u603b\u91cf",dataIndex:"totalCount"},{title:"\u5df2\u8bfb\u53d6\u6570\u636e",dataIndex:"handlerCount"},{title:"\u672a\u8bfb\u6570\u636e",dataIndex:"unHandlerCount"}];return P.a.createElement(U["a"],{title:"\u6570\u636e\u76ee\u7684\u5730",wrapperClassName:O.a.missionDetailWrapper},P.a.createElement("div",null,P.a.createElement(c["a"],{className:O.a.detailTitle+" "+O.a.destinationName},P.a.createElement(u["a"],{span:13},P.a.createElement("div",{className:O.a.detailSourceName,title:N.hasOwnProperty("name")?N.name:"---"},N.hasOwnProperty("name")?N.name:"---"),P.a.createElement("div",{className:O.a.detailSourceBtns},P.a.createElement(p["a"],{type:"exclamation-circle",style:{marginRight:20,fontSize:24,color:N.hasOwnProperty("state")?A["a"].lodash.isUndefined(B["e"][N.state])?B["e"]["UNKNOWN"].color:B["e"][N.state].color:B["e"]["UNKNOWN"].color},title:N.hasOwnProperty("state")?A["a"].lodash.isUndefined(B["e"][N.state])?B["e"]["UNKNOWN"].label:B["e"][N.state].label:B["e"]["UNKNOWN"].label}),P.a.createElement(m["a"],{disabled:N.state!==B["e"]["INACTIVED"].value&&N.state!==B["e"]["FAILED"].value,title:"\u6fc0\u6d3b",shape:"circle",icon:"bulb",size:"small",onClick:function(){return e.handleDestination(N,"activate")}}),P.a.createElement(m["a"],{disabled:N.state!==B["e"]["PAUSED"].value,title:"\u5f00\u59cb",shape:"circle",icon:"caret-right",size:"small",onClick:function(){return e.handleDestination(N,"resume")}}),P.a.createElement(m["a"],{disabled:N.state!==B["e"]["RUNNING"].value,title:"\u6682\u505c",shape:"circle",icon:"pause",size:"small",onClick:function(){return e.handleDestination(N,"pause")}}),P.a.createElement(m["a"],{disabled:N.state!==B["e"]["RUNNING"].value&&N.state!==B["e"]["PAUSED"].value,title:"\u91cd\u542f",shape:"circle",icon:"reload",size:"small",onClick:function(){return e.handleDestination(N,"restart")}}))),P.a.createElement(u["a"],{span:11,className:O.a.detailBtns,style:{textAlign:"right"}},P.a.createElement("span",null,"\u66f4\u65b0\u65f6\u95f4\uff1a"),P.a.createElement("span",null,N?N.updateDate:"--"),P.a.createElement(m["a"],{loading:a,type:"primary",onClick:this.updateDistributeDetailInfo,style:{marginLeft:10}},P.a.createElement("span",null,"\u5237\u65b0")))),P.a.createElement(d["a"],{className:O.a.detailLine,extra:P.a.createElement("div",{className:O.a.salesExtraWrap},P.a.createElement("div",{className:O.a.salesExtra},P.a.createElement("a",{className:this.isActive("30min"),onClick:function(){return e.selectDate("30min")}},P.a.createElement(M["FormattedMessage"],{id:"app.analysis.30min",defaultMessage:"30min"})),P.a.createElement("a",{className:this.isActive("1day"),onClick:function(){return e.selectDate("1day")}},P.a.createElement(M["FormattedMessage"],{id:"app.analysis.1day",defaultMessage:"1day"})),P.a.createElement("a",{className:this.isActive("3days"),onClick:function(){return e.selectDate("3days")}},P.a.createElement(M["FormattedMessage"],{id:"app.analysis.3days",defaultMessage:"3days"})),P.a.createElement("a",{className:this.isActive("7days"),onClick:function(){return e.selectDate("7days")}},P.a.createElement(M["FormattedMessage"],{id:"app.analysis.7days",defaultMessage:"7days"}))),P.a.createElement(V,{value:h,onChange:this.handleRangePickerChange,style:{width:340},showTime:!0}))},i?P.a.createElement(o["a"],null):P.a.createElement(H["a"],{rateLineData:D})),P.a.createElement(d["a"],{style:{marginBottom:20}},P.a.createElement(c["a"],{className:O.a.detailTitle},P.a.createElement(u["a"],{span:8},P.a.createElement("span",null,"\u63a5\u5165\u4eba\uff1a"),P.a.createElement("span",null,N&&N.hasOwnProperty("createBy")?N.createBy:"---")),P.a.createElement(u["a"],{span:8,className:O.a.detailBtns},P.a.createElement("span",null,"\u521b\u5efa\u65f6\u95f4\uff1a"),P.a.createElement("span",null,N&&N.hasOwnProperty("createDate")?N.createDate:"---"))),P.a.createElement(c["a"],{className:O.a.detailTitle},P.a.createElement(u["a"],{span:24},P.a.createElement("span",null,"\u63cf\u8ff0\uff1a"),P.a.createElement("span",null,N.hasOwnProperty("desc")?N.desc:"---")))),P.a.createElement("div",{className:O.a.detailItem},P.a.createElement("div",{className:O.a.detailTitleName},"\u8fd0\u884c\u72b6\u6001"),P.a.createElement("div",{className:O.a.tableContainer},P.a.createElement(l["a"],{className:O.a.detailTable,dataSource:E&&E.hasOwnProperty("tasks")?E.tasks:[],pagination:!1,columns:y,onChange:this.pageChange}))),P.a.createElement("div",{className:O.a.detailItem},P.a.createElement("div",{className:O.a.detailTitleName},"\u6570\u636e\u7edf\u8ba1"),P.a.createElement("div",{className:O.a.tableContainer},P.a.createElement(c["a"],null,P.a.createElement(u["a"],{span:8},P.a.createElement("span",null,"\u7d2f\u8ba1\u6570\u636e\u603b\u91cf\uff1a"),P.a.createElement("span",null,b&&b.hasOwnProperty("totalCount")?b.totalCount:"---")),P.a.createElement(u["a"],{span:8,className:O.a.detailBtns},P.a.createElement("span",null,"\u5df2\u8bfb\u53d6\u6570\u636e\u603b\u91cf\uff1a"),P.a.createElement("span",null,b&&b.hasOwnProperty("handlerCount")?b.handlerCount:"---")),P.a.createElement(u["a"],{span:8},P.a.createElement("span",null,"\u672a\u8bfb\u53d6\u6570\u636e\u603b\u91cf\uff1a"),P.a.createElement("span",null,b&&b.hasOwnProperty("unHandlerCount")?b.unHandlerCount:"---"))),P.a.createElement(l["a"],{className:O.a.detailTable,dataSource:b&&b.hasOwnProperty("statistics")?b.statistics:[],pagination:!1,columns:v,onChange:this.pageChange}))),P.a.createElement("div",{className:O.a.detailItem},P.a.createElement("div",{className:O.a.detailTitleName},"\u65e5\u5fd7\u4fe1\u606f"),P.a.createElement(d["a"],{style:{marginBottom:20}},P.a.createElement(c["a"],{className:O.a.detailTitle},P.a.createElement(u["a"],{span:24},P.a.createElement(r["a"],{dataSource:f?f.length>10?A["a"].lodash.slice(f,0,9):f:[],renderItem:function(e,t){return P.a.createElement(r["a"].Item,{key:t},P.a.createElement("span",{style:{width:"100%",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"},title:e},e))}})))))))}}]),t}(S["PureComponent"]),i=s))||i);t["default"]=F}}]);